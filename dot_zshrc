export LSCOLORS=cxfxcxdxbxegedabagacad
alias ll='ls -lGF'
alias ls='ls -GF'

if [[ $(command -v exa) ]]; then
  alias e='exa --icons --git'
  alias l=e
  alias ls=e
  alias ea='exa -a --icons --git'
  alias la=ea
  alias ee='exa -aahl --icons --git'
  alias ll=ee
  alias et='exa -T -L 3 -a -I "node_modules|.git|.cache" --icons'
  alias lt=et
  alias eta='exa -T -a -I "node_modules|.git|.cache" --color=always --icons | less -r'
  alias lta=eta
fi

alias air="BluetoothConnector --connect 0c-3b-50-68-b4-73 --notify"
alias vi="nvim"
alias nv="nvim"

alias zshrc="vi ~/.zshrc && source ~/.zshrc"

if type brew &>/dev/null; then
  FPATH=$(brew --prefix)/share/zsh-completions:$FPATH
  FPATH=$(brew --prefix)/share/zsh/site-functions:$FPATH

  autoload -Uz compinit
  compinit
fi

# zsh autosuggestions
if type brew &>/dev/null; then
  . $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh
fi

if type asdf &>/dev/null; then
  . $(brew --prefix asdf)/libexec/asdf.sh
fi

if type zoxide &>/dev/null; then
  eval "$(zoxide init zsh)"
fi

function gf() {
  local destination_dir="$(ghq list | fzf)"
  if [ -n "$destination_dir" ]; then
    BUFFER="cd $(ghq list --full-path --exact $destination_dir)"
    zle accept-line
  fi
  zle clear-screen
}
zle -N gf
bindkey '^]' gf


if type fzf &>/dev/null && type tmux &>/dev/null; then
  export FZF_CTRL_T_COMMAND='rg --files --hidden --follow --glob "!.git/*"'
  export FZF_CTRL_T_OPTS="
      --preview 'bat  --color=always --style=header,grid --line-range :100 {}'
  "
  [ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
  # FZF使用時はtmuxでPOPUP
  export FZF_TMUX=1
  export FZF_TMUX_OPTS="-p 80%"
fi

if type brew &>/dev/null; then
  eval "$(starship init zsh)"
fi

# fbr - checkout git branch
function fzf-checkout-branch() {
  local branches branch
  branches=$(git branch | sed -E 's/\* |  //g' | cut -d " " -f 1) &&
  branch=$(echo "$branches" | fzf --preview "git show --color=always {}") &&
  git checkout "$branch"
  zle accept-line
}
zle     -N   fzf-checkout-branch
bindkey "^b" fzf-checkout-branch

# wrap_zoxide
functions __wrap_zoxide(){
  zi
  zle accept-line
}
zle -N __wrap_zoxide
bindkey "^k" __wrap_zoxide

